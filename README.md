# Руководство по автотестам

## Оглавление

- [Описание тегов](#описание-тегов)
- [Запуск тестов](#запуск-тестов)
- [Формирование отчета Allure](#формирование-отчета-allure)
- [Формирование отчета для DOQA](#формирование-отчета-для-doqa)
- [Множественная регистрация](#множественная-регистрация)


### Описание тегов: <a name="описание-тегов"></a>

| Тег                         | Описание                                                  |
|------------------------------|-----------------------------------------------------------|
| `@Tag("API_TEST")`          | АПИ тесты по загрузке основных страниц и таблиц           |
| `@Tag("PROD")`              | АПИ тесты для прода по загрузке основных страниц и таблиц |
| `@Tag("IN_WORK")`           | Тесты, находящиеся в процессе разработки                  |
| `@Tag("ANIMAL_REGISTRATION")` | Регистрация животных                                      |
| `@Tag("REGISTRATION_ENTERPRISE_OBJECT")` | Регистрация ПП и ПО                                       |
| `@Tag("TASK")`                | Создание заданий                                          |
| `@Tag("EPIZOOTOLOGY")`       | Эпизоотология (включая выполнение описи)                  |
| `@Tag("REGRESS")`            | Регресс                                                   |
| `@Tag("DISPOSAL")`           | Выбытие                                                   |

### Запуск тестов: <a name="запуск-тестов"></a>

**Примеры команд:**

| Описание                                      | Команда                                                                        |
|-----------------------------------------------|--------------------------------------------------------------------------------|
| Запуск всех тестов внутри пакета и подпакетов | ./gradlew test --tests "НАЗВАНИЕ ПАКЕТА.**"                                    |
| Запуск конкретного теста                      | ./gradlew test --tests НАЗВАНИЕ ТЕСТОВОГО ФАЙЛА                                |
| Регресс (исключая PROD и IN_WORK)             | ./gradlew test --tests "REGRESS" -x "PROD" -x "IN_WORK"                        |
| Выбытие                                       | ./gradlew test --tests "DISPOSAL" -x "PROD" -x "IN_WORK"                       |
| Эпизоотология (включая выполнение описи)      | ./gradlew test --tests "EPIZOOTOLOGY" -x "PROD" -x "IN_WORK"                   |
| Создание заданий                              | ./gradlew test --tests "TASK" -x "PROD" -x "IN_WORK"                           |
| Регистрация ПП и ПО                           | ./gradlew test --tests "REGISTRATION_ENTERPRISE_OBJECT" -x "PROD" -x "IN_WORK" |
| Регистрация животных                          | ./gradlew test --tests "ANIMAL_REGISTRATION" -x "PROD" -x "IN_WORK"            |
| API тесты                                     | ./gradlew test --tests "API_TEST" -x "PROD" -x "IN_WORK"                       |
 | PROD                                          | ./gradlew test --tests "*PROD*" -x "*IN_WORK*"                                 |


## Формирование отчета Allure: <a name="формирование-отчета-allure"></a>
- Динамический отчет (открывается в браузере и доступен до следующего запуска тестов)

  **./gradlew allureServe**


- Статический отчет (создается html файл и сохраняется в папку allure-report)

  **allure generate build/allure-results --clean --output-dir allure-report --single-file**

## Формирование отчета для DOQA <a name="формирование-отчета-для-doqa"></a>


Java-файл объединения отчётов JUnit XML -   *"MergeJUnitXmlReports.java"* 

1. После внесения изменений необходимо скомпилировать файл с помощью команды, находясь в нем

   **javac MergeJUnitXmlReports.java**

2. Появится файл **MergeJUnitXmlReports.class**
3. Cкопировать отчеты для объединения в папку **"./doqa/xml_FOR_report"**
    
   или указать в MergeJUnitXmlReports.java перед компиляцией папку, куда сохраняются отчеты после прохождения(**хранятся до следующего запуска**)
    **"./test-results/test"**

4. Получить файл **"./doqa/finished_reports/merged_test_report.xml"** готовый для загрузки в DOQA


## Множественная регистрация <a name="множественная-регистрация"></a>

Для запуска теста несколько раз (например для множественной регистрации) можно использовать аннотацию:

**@RepeatedTest(указать_количество_повторений)**
